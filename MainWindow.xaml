<Window x:Class="ClearGlass.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ClearGlass"
        Title="Clear Glass" Height="600" Width="500"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        BorderThickness="1"
        BorderBrush="{StaticResource GlassBorder}">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <local:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        <Style TargetType="ToggleButton">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Height" Value="26"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <Border x:Name="BackgroundBorder"
                                    Background="{StaticResource GlassBackground}"
                                    CornerRadius="13"
                                    BorderThickness="1"
                                    BorderBrush="{StaticResource GlassBorder}">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="10" Color="#40000000"/>
                                </Border.Effect>
                            </Border>
                            <Border x:Name="Slider"
                                    Width="20" Height="20"
                                    CornerRadius="10"
                                    Background="{StaticResource TextPrimary}"
                                    HorizontalAlignment="Left"
                                    Margin="3,0,0,0">
                                <Border.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="5" Color="#40000000"/>
                                </Border.Effect>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation 
                                                Storyboard.TargetName="BackgroundBorder"
                                                Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                To="#2196F3"
                                                Duration="0:0:0.2"/>
                                            <ThicknessAnimation 
                                                Storyboard.TargetName="Slider"
                                                Storyboard.TargetProperty="Margin"
                                                To="27,0,0,0"
                                                Duration="0:0:0.2">
                                                <ThicknessAnimation.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </ThicknessAnimation.EasingFunction>
                                            </ThicknessAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation 
                                                Storyboard.TargetName="BackgroundBorder"
                                                Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                                To="#20FFFFFF"
                                                Duration="0:0:0.2"/>
                                            <ThicknessAnimation 
                                                Storyboard.TargetName="Slider"
                                                Storyboard.TargetProperty="Margin"
                                                To="3,0,0,0"
                                                Duration="0:0:0.2">
                                                <ThicknessAnimation.EasingFunction>
                                                    <CubicEase EasingMode="EaseOut"/>
                                                </ThicknessAnimation.EasingFunction>
                                            </ThicknessAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
        </Style>
        <Style TargetType="Grid">
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Background" Value="{StaticResource PrimaryBlue}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="20"
                                BorderThickness="1"
                                BorderBrush="{StaticResource GlassBorder}">
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="0" BlurRadius="10" Color="#40000000"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="15,5"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource LightBlue}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource DarkBlue}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- New style for tiny transparent buttons -->
        <Style x:Key="TinyButton" TargetType="Button">
            <Setter Property="Height" Value="28"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#AAFFFFFF"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="14"
                                BorderThickness="1"
                                BorderBrush="#40FFFFFF"
                                Padding="0,2">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="8,2"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#20FFFFFF"/>
                                <Setter Property="Foreground" Value="#FFFFFF"/>
                                <Setter Property="BorderBrush" Value="#60FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#30FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Custom ScrollViewer Style -->
        <Style TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <ScrollContentPresenter Grid.Column="0" 
                                                  Margin="{TemplateBinding Padding}"/>
                            
                            <ScrollBar x:Name="PART_VerticalScrollBar"
                                     Grid.Column="1"
                                     Orientation="Vertical"
                                     ViewportSize="{TemplateBinding ViewportHeight}"
                                     Maximum="{TemplateBinding ScrollableHeight}"
                                     Value="{TemplateBinding VerticalOffset}"
                                     Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}">
                                <ScrollBar.Style>
                                    <Style TargetType="ScrollBar">
                                        <Setter Property="Width" Value="8"/>
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ScrollBar">
                                                    <Grid>
                                                        <Track x:Name="PART_Track" 
                                                               IsDirectionReversed="True">
                                                            <Track.Thumb>
                                                                <Thumb x:Name="Thumb" 
                                                                       Background="#40FFFFFF"
                                                                       BorderThickness="0">
                                                                    <Thumb.Style>
                                                                        <Style TargetType="Thumb">
                                                                            <Setter Property="Template">
                                                                                <Setter.Value>
                                                                                    <ControlTemplate TargetType="Thumb">
                                                                                        <Border Background="{TemplateBinding Background}"
                                                                                                CornerRadius="4"/>
                                                                                    </ControlTemplate>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                            <Style.Triggers>
                                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                                    <Setter Property="Background" Value="#60FFFFFF"/>
                                                                                </Trigger>
                                                                                <Trigger Property="IsDragging" Value="True">
                                                                                    <Setter Property="Background" Value="#80FFFFFF"/>
                                                                                </Trigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Thumb.Style>
                                                                </Thumb>
                                                            </Track.Thumb>
                                                        </Track>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ScrollBar.Style>
                            </ScrollBar>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Storyboard x:Key="ShowAddonsOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="AddonsOverlay"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="AddonsOverlay"
                Storyboard.TargetProperty="Margin"
                From="0,600,0,-600" To="10,10,10,10" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
        
        <Storyboard x:Key="HideAddonsOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="AddonsOverlay"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="AddonsOverlay"
                Storyboard.TargetProperty="Margin"
                From="10,10,10,10" To="0,600,0,-600" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowOptimizationOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="OptimizationOverlay"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="OptimizationOverlay"
                Storyboard.TargetProperty="Margin"
                From="0,600,0,-600" To="10,10,10,10" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
        
        <Storyboard x:Key="HideOptimizationOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="OptimizationOverlay"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="OptimizationOverlay"
                Storyboard.TargetProperty="Margin"
                From="10,10,10,10" To="0,600,0,-600" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowKeepAppsOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="KeepAppsOverlay"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="KeepAppsOverlay"
                Storyboard.TargetProperty="Margin"
                From="0,600,0,-600" To="10,10,10,10" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
        
        <Storyboard x:Key="HideKeepAppsOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="KeepAppsOverlay"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="KeepAppsOverlay"
                Storyboard.TargetProperty="Margin"
                From="10,10,10,10" To="0,600,0,-600" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowTweaksOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="TweaksOverlay"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="TweaksOverlay"
                Storyboard.TargetProperty="Margin"
                From="0,600,0,-600" To="10,10,10,10" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
        
        <Storyboard x:Key="HideTweaksOverlay">
            <DoubleAnimation 
                Storyboard.TargetName="TweaksOverlay"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation 
                Storyboard.TargetName="TweaksOverlay"
                Storyboard.TargetProperty="Margin"
                From="10,10,10,10" To="0,600,0,-600" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <Storyboard x:Key="ShowRemoveAppsOverlay">
            <DoubleAnimation Storyboard.TargetName="RemoveAppsOverlay"
                           Storyboard.TargetProperty="Opacity"
                           From="0" To="1"
                           Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation Storyboard.TargetName="RemoveAppsOverlay"
                              Storyboard.TargetProperty="Margin"
                              From="0,600,0,-600" To="0"
                              Duration="0:0:0.3">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <Storyboard x:Key="HideRemoveAppsOverlay">
            <DoubleAnimation Storyboard.TargetName="RemoveAppsOverlay"
                           Storyboard.TargetProperty="Opacity"
                           From="1" To="0"
                           Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation Storyboard.TargetName="RemoveAppsOverlay"
                              Storyboard.TargetProperty="Margin"
                              From="0" To="0,600,0,-600"
                              Duration="0:0:0.3">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
    </Window.Resources>

    <Grid>
        <Border CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="10">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20,20,20,35">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0" Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Clear Glass"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseButtonClick"/>
                </Grid>

                <StackPanel Grid.Row="1" Margin="40,0,40,0">
                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Taskbar:"
                                 Grid.Column="0"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TextPrimary}">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="0" 
                                                  BlurRadius="20" 
                                                  Color="#40000000" 
                                                  Opacity="0.5"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock Text="Left" Grid.Column="1" VerticalAlignment="Center" Margin="0"/>
                        <ToggleButton x:Name="TaskbarAlignmentToggle"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    Margin="0"
                                    Click="OnTaskbarAlignmentToggle"/>
                        <TextBlock Text="Center" Grid.Column="3" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Task View:"
                                 Grid.Column="0"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TextPrimary}">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="0" 
                                                  BlurRadius="20" 
                                                  Color="#40000000" 
                                                  Opacity="0.5"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock Text="Hide" Grid.Column="1" VerticalAlignment="Center" Margin="0"/>
                        <ToggleButton x:Name="TaskViewToggle"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    Margin="0"
                                    Click="OnTaskViewToggle"/>
                        <TextBlock Text="Show" Grid.Column="3" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="140"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Search:"
                                 Grid.Column="0"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TextPrimary}">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="0" 
                                                  BlurRadius="20" 
                                                  Color="#40000000" 
                                                  Opacity="0.5"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock Text="Hide" Grid.Column="1" VerticalAlignment="Center" Margin="0"/>
                        <ToggleButton x:Name="SearchToggle"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    Margin="0"
                                    Click="OnSearchToggle"/>
                        <TextBlock Text="Icon" Grid.Column="3" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Desktop Icons:"
                                 Grid.Column="0"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TextPrimary}">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="0" 
                                                  BlurRadius="20" 
                                                  Color="#40000000" 
                                                  Opacity="0.5"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock Text="Hide" Grid.Column="1" VerticalAlignment="Center" Margin="0"/>
                        <ToggleButton x:Name="DesktopIconsToggle"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    Margin="0"
                                    Click="OnDesktopIconsToggle"/>
                        <TextBlock Text="Show" Grid.Column="3" VerticalAlignment="Center"/>
                    </Grid>

                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="140"/>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Theme:"
                                 Grid.Column="0"
                                 FontSize="14"
                                 FontWeight="SemiBold"
                                 Foreground="{StaticResource TextPrimary}">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="0" 
                                                  BlurRadius="20" 
                                                  Color="#40000000" 
                                                  Opacity="0.5"/>
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock Text="Light" Grid.Column="1" VerticalAlignment="Center" Margin="0"/>
                        <ToggleButton x:Name="ThemeToggle"
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    Margin="0"
                                    Click="OnThemeToggle"/>
                        <TextBlock Text="Dark" Grid.Column="3" VerticalAlignment="Center"/>
                    </Grid>
                </StackPanel>

                <!-- Action buttons section -->
                <Grid Grid.Row="2" Margin="0,10,0,10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Recommended Addons Button -->
                    <Button Grid.Row="0"
                            Grid.ColumnSpan="2"
                            Content="Recommended Addons" 
                            Style="{StaticResource ActionButton}"
                            Width="200"
                            Height="36"
                            x:Name="RecommendedAddonsButton"
                            Click="OnRecommendedAddonsClick"
                            Margin="0,0,0,15"
                            HorizontalAlignment="Center"/>

                    <Button Content="Clear Glass Theme" 
                            Grid.Row="1"
                            Grid.Column="0"
                            Style="{StaticResource ActionButton}"
                            Margin="0,0,10,15"
                            x:Name="ClearGlassThemeButton"
                            Click="OnClearGlassThemeClick"/>

                    <Button Content="Windows Optimization" 
                            Grid.Row="1"
                            Grid.Column="1"
                            Style="{StaticResource ActionButton}"
                            Margin="10,0,0,15"
                            x:Name="WindowsOptimizationButton"
                            Click="OnWindowsOptimizationClick"/>

                    <Button Content="Run Clear Glass" 
                            Grid.Row="2"
                            Grid.ColumnSpan="2"
                            Style="{StaticResource ActionButton}"
                            Width="200"
                            Margin="0,0,0,20"
                            x:Name="ClearGlassButton"
                            Click="OnClearGlassClick"/>

                    <!-- Tiny buttons -->
                    <StackPanel Grid.Row="3" 
                              Grid.ColumnSpan="2"
                              Orientation="Horizontal" 
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Margin="0,5,0,10">
                        <Button Content="Auto Login" 
                                Style="{StaticResource TinyButton}"
                                Width="75"
                                Height="28"
                                Margin="0,0,5,0"
                                x:Name="AutoLoginButton"
                                Click="OnAutoLoginClick"/>
                        <Button Content="Keep Apps" 
                                Style="{StaticResource TinyButton}"
                                Width="75"
                                Height="28"
                                Margin="5,0"
                                x:Name="KeepAppsButton"
                                Click="OnKeepAppsClick"/>
                        <Button Content="Tweaks" 
                                Style="{StaticResource TinyButton}"
                                Width="75"
                                Height="28"
                                Margin="5,0"
                                x:Name="TweaksButton"
                                Click="OnTweaksClick"/>
                        <Button Content="Uninstaller"
                                Style="{StaticResource TinyButton}"
                                Width="75"
                                Height="28"
                                Margin="5,0"
                                x:Name="RemoveAppsButton"
                                Click="OnRemoveAppsClick"/>
                        <Button Content="Support Us" 
                                Style="{StaticResource TinyButton}"
                                Width="75"
                                Height="28"
                                Margin="5,0,0,0"
                                x:Name="SupportUsButton"
                                Click="OnSupportUsClick"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Addons Overlay -->
        <Border x:Name="AddonsOverlay"
                CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="0,600,0,-600"
                Opacity="0"
                Panel.ZIndex="1000">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Recommended Addons"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseAddonsButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseAddonsClick"/>
                </Grid>

                <Grid Grid.Row="1" 
                      Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <ScrollViewer Grid.Row="0"
                                VerticalScrollBarVisibility="Auto"
                                HorizontalScrollBarVisibility="Disabled"
                                Padding="0,0,5,0">
                        <StackPanel>
                            <!-- LibreWolf -->
                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Icon -->
                                    <Image Source="pack://application:,,,/Images/librewolf.png"
                                           Width="40"
                                           Height="40"
                                           VerticalAlignment="Top"/>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="1"
                                              Margin="15,0,0,0">
                                        <TextBlock Text="LibreWolf"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="LibreWolf is a privacy-focused web browser built from the Firefox source code. It aims to provide a more secure and private browsing experience by removing telemetry (data collection) and other non-essential features that could compromise user privacy."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Download"
                                                Style="{StaticResource TinyButton}"
                                                Width="80"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnLibreWolfDownloadClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Brave Browser -->
                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Icon -->
                                    <Image Source="pack://application:,,,/Images/brave.png"
                                           Width="40"
                                           Height="40"
                                           VerticalAlignment="Top"/>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="1"
                                              Margin="15,0,0,0">
                                        <TextBlock Text="Brave Browser"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="Brave is a privacy-focused web browser that blocks trackers and malicious ads by default. It features built-in privacy protection, a crypto wallet, and rewards system. The browser is designed to be fast, secure, and protect user privacy while maintaining compatibility with Chrome extensions."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Download"
                                                Style="{StaticResource TinyButton}"
                                                Width="80"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnBraveDownloadClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Revo Uninstaller -->
                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Icon -->
                                    <Image Source="pack://application:,,,/Images/revo.png"
                                           Width="40"
                                           Height="40"
                                           VerticalAlignment="Top"/>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="1"
                                              Margin="15,0,0,0">
                                        <TextBlock Text="Revo Uninstaller Pro"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="Revo Uninstaller Pro is a powerful software tool designed to help users completely uninstall applications from Windows systems. Features advanced scanning modes, forced uninstall, real-time monitoring, and batch uninstallation. Ideal for: Users who frequently install and remove software, or who need to cleanly get rid of problematic programs."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Download"
                                                Style="{StaticResource TinyButton}"
                                                Width="80"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnRevoDownloadClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Download Bundle Button -->
                    <Button Grid.Row="1"
                            Content="Download Bundle"
                            Style="{StaticResource ActionButton}"
                            Width="200"
                            Height="36"
                            Margin="0,20,0,0"
                            HorizontalAlignment="Center"
                            x:Name="DownloadBundleButton"
                            Click="OnDownloadBundleClick"/>
                </Grid>
            </Grid>
        </Border>

        <!-- Optimization Overlay -->
        <Border x:Name="OptimizationOverlay"
                CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="0,600,0,-600"
                Opacity="0"
                Panel.ZIndex="1000">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Windows Optimization"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseOptimizationButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseOptimizationClick"/>
                </Grid>

                <StackPanel VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,0,0,10">
                    <CheckBox x:Name="RestorePointCheckBox"
                              Content="Create a restore point before making changes"
                              IsChecked="True"
                              Margin="0,0,0,15"
                              Foreground="{StaticResource TextPrimary}"/>
                    <ScrollViewer Grid.Row="1"
                                VerticalScrollBarVisibility="Auto"
                                HorizontalScrollBarVisibility="Disabled"
                                Padding="0,0,5,0">
                        <StackPanel VerticalAlignment="Top" 
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,10">
                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Windows Settings Optimization"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="This will optimize various Windows settings including: disabling telemetry and data collection, optimizing visual effects for performance, adjusting power settings for better responsiveness, and configuring privacy settings. A system restore point will be created before making changes."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Optimize Settings"
                                                Style="{StaticResource TinyButton}"
                                                Width="120"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnTweakSettingsClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Remove Windows Bloatware"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="This will remove unnecessary Windows apps while keeping essential system components and useful applications. A system restore point will be created before making changes."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Remove Bloatware"
                                                Style="{StaticResource TinyButton}"
                                                Width="120"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnRemoveBloatwareClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <Border Background="#20FFFFFF"
                                    CornerRadius="10"
                                    Margin="0,0,0,15"
                                    Padding="15">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- App Info -->
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Full System Optimization"
                                                 FontSize="16"
                                                 FontWeight="SemiBold"
                                                 Foreground="{StaticResource TextPrimary}"
                                                 Margin="0,0,0,5"/>
                                        <TextBlock Text="This will perform a complete system optimization including Windows settings tweaks and bloatware removal. A system restore point will be created before making changes."
                                                 TextWrapping="Wrap"
                                                 Foreground="{StaticResource TextSecondary}"
                                                 LineHeight="20"/>
                                        <Button Content="Run Optimization"
                                                Style="{StaticResource TinyButton}"
                                                Width="120"
                                                Margin="0,10,0,0"
                                                HorizontalAlignment="Left"
                                                Click="OnRunOptimizationClick"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Keep Apps Overlay -->
        <Border x:Name="KeepAppsOverlay"
                CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="0,600,0,-600"
                Opacity="0"
                Panel.ZIndex="1000">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Apps to Keep During Cleanup"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseKeepAppsButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseKeepAppsClick"/>
                </Grid>

                <!-- Search Bar -->
                <Border Grid.Row="1"
                        Background="#20FFFFFF"
                        CornerRadius="5"
                        Margin="0,0,0,10"
                        Width="300"
                        HorizontalAlignment="Center"
                        BorderThickness="1"
                        BorderBrush="#40FFFFFF">
                    <TextBox x:Name="KeepAppsSearchBox"
                            Padding="10,5"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            FontSize="14"
                            CaretBrush="White"
                            TextAlignment="Left"
                            TextChanged="OnKeepAppsSearchTextChanged">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#30FFFFFF"/>
                                    </Trigger>
                                    <Trigger Property="IsFocused" Value="True">
                                        <Setter Property="Background" Value="#30FFFFFF"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                        <TextBox.Template>
                            <ControlTemplate TargetType="TextBox">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost" 
                                                Margin="0"
                                                VerticalAlignment="Center"/>
                                    <TextBlock Text="Search applications..."
                                             Foreground="#80FFFFFF"
                                             FontSize="14"
                                             HorizontalAlignment="Left"
                                             VerticalAlignment="Center"
                                             Margin="10,0,0,0"
                                             Visibility="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToVisibilityConverter}}"/>
                                </Grid>
                            </ControlTemplate>
                        </TextBox.Template>
                    </TextBox>
                </Border>

                <!-- Scrollable Applications List -->
                <ScrollViewer Grid.Row="2"
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Disabled"
                            Padding="0,0,5,0"
                            Margin="0,0,0,20">
                    <ItemsControl x:Name="AppsListView">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#20FFFFFF"
                                        CornerRadius="10"
                                        Margin="0,0,0,10"
                                        Padding="15">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <CheckBox IsChecked="{Binding IsSelected}"
                                                VerticalAlignment="Center"
                                                Margin="0,0,15,0"/>
                                        <StackPanel Grid.Column="1">
                                            <TextBlock Text="{Binding DisplayName}"
                                                     FontSize="16"
                                                     FontWeight="SemiBold"
                                                     Foreground="{StaticResource TextPrimary}"
                                                     Margin="0,0,0,5"/>
                                            <TextBlock Text="{Binding Id}"
                                                     TextWrapping="Wrap"
                                                     Foreground="{StaticResource TextSecondary}"
                                                     LineHeight="20"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <Button Grid.Row="3"
                        Content="Apply Changes"
                        Style="{StaticResource ActionButton}"
                        Width="200"
                        Height="36"
                        x:Name="ApplyKeepAppsButton"
                        Click="OnApplyKeepAppsClick"
                        HorizontalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Tweaks Overlay -->
        <Border x:Name="TweaksOverlay"
                CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="0,600,0,-600"
                Opacity="0"
                Panel.ZIndex="1000">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Windows Tweaks"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseTweaksButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseTweaksClick"/>
                </Grid>

                <ScrollViewer Grid.Row="1" 
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Disabled"
                            Padding="0,0,5,0">
                    <StackPanel VerticalAlignment="Top" 
                              HorizontalAlignment="Center"
                              Margin="0,0,0,10">
                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Remove OneDrive"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="This will completely remove Microsoft OneDrive from your system using multiple methods to ensure thorough removal. Before proceeding, make sure to stop OneDrive sync and back up any important files. This is a safe operation but requires proper preparation to avoid data loss."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Remove OneDrive"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnRemoveOneDriveClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Sign Out of Microsoft Account"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Open the User Accounts section in Control Panel to manage your Microsoft account settings. To sign out, click 'Make changes to my account in PC settings' and then select 'Sign out'."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Open User Accounts"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnOpenUserAccountsClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Windows Settings"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Open the modern Windows Settings app to configure your system preferences and options."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Open Settings"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnOpenSettingsClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Control Panel"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Open the classic Windows Control Panel for advanced system configuration options."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Open Control Panel"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnOpenControlPanelClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Disable Search Suggestions"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="This will disable web search suggestions and Bing integration in the Windows search box, improving privacy and reducing unnecessary network traffic."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Disable Suggestions"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnDisableSearchSuggestionsClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Windows Image Backup"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Create a system image backup of your Windows installation. This creates a complete backup of your system drive that can be used to restore your PC."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Open Backup"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnOpenBackupClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Registry Editor"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Open the Windows Registry Editor to view and modify system settings. Be cautious when making changes as they can affect system stability."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Open Registry Editor"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnOpenRegistryEditorClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Disable Privacy Permissions"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Disable personalized ads, local content based on language, app launch tracking, and suggested content in the settings app to enhance your privacy."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Disable Permissions"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnDisablePrivacyPermissionsClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Enable End Task in Taskbar"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Enable the ability to end tasks directly from the taskbar by right-clicking. This adds an 'End Task' option to the context menu when right-clicking taskbar items."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Enable End Task"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnEnableEndTaskClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Set This PC as Default"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Set 'This PC' as the default view in File Explorer by removing Home and Gallery views. This provides a cleaner, more traditional file management experience."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Set This PC Default"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnSetThisPCDefaultClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <Border Background="#20FFFFFF"
                                CornerRadius="10"
                                Margin="0,0,0,15"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- App Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Restore Classic Context Menu"
                                             FontSize="16"
                                             FontWeight="SemiBold"
                                             Foreground="{StaticResource TextPrimary}"
                                             Margin="0,0,0,5"/>
                                    <TextBlock Text="Restore the classic (full) right-click context menu from Windows 10, removing the extra 'Show more options' step. This provides immediate access to all context menu items."
                                             TextWrapping="Wrap"
                                             Foreground="{StaticResource TextSecondary}"
                                             LineHeight="20"/>
                                    <Button Content="Restore Classic Menu"
                                            Style="{StaticResource TinyButton}"
                                            Width="120"
                                            Margin="0,10,0,0"
                                            HorizontalAlignment="Left"
                                            Click="OnRestoreClassicMenuClick"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Remove Applications Overlay -->
        <Border x:Name="RemoveAppsOverlay"
                CornerRadius="10" 
                Background="#80000000" 
                BorderThickness="1" 
                BorderBrush="{StaticResource GlassBorder}"
                Margin="0,600,0,-600"
                Opacity="0"
                Panel.ZIndex="1000">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="0" Color="#40000000"/>
            </Border.Effect>
            
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Height="30" VerticalAlignment="Top" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="Uninstall Applications"
                               Grid.Column="1"
                               FontSize="28"
                               FontWeight="Normal"
                               FontFamily="Gabriola, 'Segoe Script', 'Brush Script MT', Cursive"
                               Foreground="{StaticResource PrimaryBlue}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="0" 
                                              BlurRadius="15" 
                                              Color="#40000000" 
                                              Opacity="0.3"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    
                    <Button x:Name="CloseRemoveAppsButton"
                            Grid.Column="2"
                            Content="✕"
                            Width="30"
                            Height="30"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            Click="OnCloseRemoveAppsClick"/>
                </Grid>

                <!-- Search Bar -->
                <Border Grid.Row="1"
                        Background="#20FFFFFF"
                        CornerRadius="5"
                        Margin="0,0,0,10"
                        Width="300"
                        HorizontalAlignment="Center"
                        BorderThickness="1"
                        BorderBrush="#40FFFFFF">
                    <TextBox x:Name="AppSearchBox"
                            Padding="10,5"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="{StaticResource TextPrimary}"
                            FontSize="14"
                            CaretBrush="White"
                            TextAlignment="Left"
                            TextChanged="OnAppSearchTextChanged">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#30FFFFFF"/>
                                    </Trigger>
                                    <Trigger Property="IsFocused" Value="True">
                                        <Setter Property="Background" Value="#30FFFFFF"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                        <TextBox.Template>
                            <ControlTemplate TargetType="TextBox">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost" 
                                                Margin="0"
                                                VerticalAlignment="Center"/>
                                    <TextBlock Text="Search applications..."
                                             Foreground="#80FFFFFF"
                                             FontSize="14"
                                             HorizontalAlignment="Left"
                                             VerticalAlignment="Center"
                                             Margin="10,0,0,0"
                                             Visibility="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToVisibilityConverter}}"/>
                                </Grid>
                            </ControlTemplate>
                        </TextBox.Template>
                    </TextBox>
                </Border>

                <!-- Scrollable Applications List -->
                <ScrollViewer Grid.Row="2"
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Disabled"
                            Padding="0,0,5,0"
                            Margin="0,0,0,20">
                    <ItemsControl x:Name="InstalledAppsList"
                                ItemsSource="{Binding}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#20FFFFFF"
                                        CornerRadius="10"
                                        Margin="0,0,0,15"
                                        Padding="15">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <CheckBox Grid.Column="0"
                                                IsChecked="{Binding IsSelected}"
                                                VerticalAlignment="Center"
                                                Margin="0,0,15,0"/>

                                        <Image Grid.Column="1"
                                               Source="{Binding Icon}"
                                               Width="40"
                                               Height="40"
                                               VerticalAlignment="Top"/>

                                        <StackPanel Grid.Column="2">
                                            <TextBlock Text="{Binding Name}"
                                                     FontSize="16"
                                                     FontWeight="SemiBold"
                                                     Foreground="{StaticResource TextPrimary}"
                                                     Margin="0,0,0,5"/>
                                            <TextBlock Text="{Binding Id}"
                                                     TextWrapping="Wrap"
                                                     Foreground="{StaticResource TextSecondary}"
                                                     LineHeight="20"/>
                                            <TextBlock Text="{Binding Version}"
                                                     Opacity="0.7"
                                                     FontSize="12"
                                                     Margin="0,5,0,0"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <Button Grid.Row="3"
                        x:Name="UninstallAppsButton"
                        Content="Uninstall Selected"
                        Style="{StaticResource ActionButton}"
                        Width="200"
                        Height="36"
                        Click="OnUninstallAppsClick"
                        HorizontalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</Window> 